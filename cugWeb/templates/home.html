{% extends "base.html" %}

{% block 首页高亮 %}
    active
{% endblock 首页高亮 %}

{% block 主体 %}
	<div class="jumbotron" style="text-align: left">
		<h1>Hello</h1><br>
        <p>今天是：<b>{{ current_time }}</b></p><br>
        <form action="#" method="post">
            {% csrf_token %}
            <div class="input-group input-group-lg">
                <input onkeyup="value=value.replace(/[\u4e00-\u9fa5]/g,'') "onbeforepaste="clipboardData.setData('text',clipboardData.getData('text').replace(/[\u4e00-\u9fa5]/g,''))" type="text" class="form-control" name="filedate" placeholder="请输入需可视化的数据所在日期（例如：2016-06-07）" >
                <span class="input-group-btn">
                     <button class="btn btn-default" type="submit" name="search">
                         <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                     </button>
                </span>
            </div><!-- /input-group -->
        </form>
        <div class="{{ input_warning }}" role="alert">
          <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">{{ close_button }}</span></button>
          <strong>{{ information }}</strong>
        </div>
        <br><br>
        <p><span class="label label-danger">关于搜索：</span></p>
        <span class="label label-info">检索数据间隔为1分钟。例如：2016-06-07 09:12:00，即秒位均为0。</span>
        <span class="label label-success">支持模糊搜索。例如：2018（检索2018年所有数据）、2018-06（检索2018年6月所有数据）。</span>
    </div>
    <hr/><br>
    <h1>热力图示</h1><br><br>
    <div id="hot_ah" style="width:100%;height:550px;; ">
        <script type="text/javascript">
            {#// 基于准备好的dom，初始化echarts实例#}
            var hot_ah= echarts.init(document.getElementById('hot_ah'));
            {#// 指定图表的配置项和数据#}
            var x = [];
            var y = [];

            for(var i = 0; i <= 10; i ++)
            {
                x[i] = i;
                y[i] = i;
            }
            var data = [];

            data = data.map(function (item) {
                return [item[1], item[0], item[2] || '-'];
            });
            var option = {
                baseOption: {
                    timeline:{
                        label:false,
                        axisType: 'category',
                        show: true,
                        autoPlay: false,
                        playInterval: 500,
                        data:{{ timeline|safe }}
                    },
                    grid: {containLabel: true},
                    title: {
                        text: 'AH'
                    },
                    tooltip: {
                        position: 'top'
                     },
                    toolbox: {
                        feature: {
                            saveAsImage: {}
                        }
                    },
                    animation: false,
                    xAxis: {
                        type: 'category',
                        data: x,
                        splitArea: {
                            show: true
                        }
                     },
                    yAxis: {
                        type: 'category',
                        data: y,
                        splitArea: {
                            show: true
                        }
                     },
                    series: [{
                        name: 'AH',
                        type: 'heatmap',
                        label: {
                            normal: {
                                show: false
                            }
                        }
                     }]
                },
                options:[]
            };
            var timeline = {{ timeline|safe }}
            var ah_value = {{ ah_value|safe }}
            for(var n = 0; n < ah_value.length; n ++)
            {
                option.options.push(
                    {
                        visualMap: {
                            min: {{ min_ah|safe }},
                            max: {{ max_ah|safe }},
                            left: 'right',
                            top: 'center',
                            inRange: {
                                color: ['#313695',
                                        '#4575b4',
                                        '#74add1',
                                        '#abd9e9',
                                        '#e0f3f8',
                                        '#ffffbf',
                                        '#fee090',
                                        '#fdae61',
                                        '#f46d43',
                                        '#d73027',
                                        '#a50026']
                            }
                         },
                        title:{
                            text: timeline[n]+" （AH）"
                        },
                        series:[
                            {
                                data:[[5,5,ah_value[n]]]
                            },
                        ]
                    },
                );
            }
            {#// 使用刚指定的配置项和数据显示图表。#}
            hot_ah.setOption(option);
        </script>
    </div><br><br>
    <div id="hot_nh" style="width:100%;height:550px;; ">
        <script type="text/javascript">
            {#// 基于准备好的dom，初始化echarts实例#}
            var hot_nh= echarts.init(document.getElementById('hot_nh'));
            {#// 指定图表的配置项和数据#}
            var x = [];
            var y = [];

            for(var i = 0; i <= 10; i ++)
            {
                x[i] = i;
                y[i] = i;
            }
            var data = [];

            data = data.map(function (item) {
                return [item[1], item[0], item[2] || '-'];
            });
            var option = {
                baseOption: {
                    timeline:{
                        label:false,
                        axisType: 'category',
                        show: true,
                        autoPlay: false,
                        playInterval: 500,
                        data:{{ timeline|safe }}
                    },
                    grid: {containLabel: true},
                    title: {
                        text: 'NH'
                    },
                    tooltip: {
                        position: 'top'
                     },
                    toolbox: {
                        feature: {
                            saveAsImage: {}
                        }
                    },
                    animation: false,
                    xAxis: {
                        type: 'category',
                        data: x,
                        splitArea: {
                            show: true
                        }
                     },
                    yAxis: {
                        type: 'category',
                        data: y,
                        splitArea: {
                            show: true
                        }
                     },
                    series: [{
                        name: 'AH',
                        type: 'heatmap',
                        label: {
                            normal: {
                                show: false
                            }
                        }
                     }]
                },
                options:[]
            };
            var timeline = {{ timeline|safe }}
            var nh_value = {{ nh_value|safe }}
            for(var n = 0; n < nh_value.length; n ++)
            {
                option.options.push(
                    {
                        visualMap: {
                            min: {{ min_nh|safe }},
                            max: {{ max_nh|safe }},
                            left: 'right',
                            top: 'center',
                            inRange: {
                                color: ['#313695',
                                        '#4575b4',
                                        '#74add1',
                                        '#abd9e9',
                                        '#e0f3f8',
                                        '#ffffbf',
                                        '#fee090',
                                        '#fdae61',
                                        '#f46d43',
                                        '#d73027',
                                        '#a50026']
                            }
                         },
                        title:{
                            text: timeline[n]+" （NH）"
                        },
                        series:[
                            {
                                data:[[5,5,nh_value[n]]]
                            },
                        ]
                    },
                );
            }
            {#// 使用刚指定的配置项和数据显示图表。#}
            hot_nh.setOption(option);
        </script>
    </div>
    <hr/><br>
{#    折线图AH#}
    <h1>折线图示</h1><br><br>
    <div id="ah" style="width:100%;height:400px;; ">
        <script type="text/javascript">
            {#// 基于准备好的dom，初始化echarts实例#}
            var ah= echarts.init(document.getElementById('ah'));
            {#// 指定图表的配置项和数据#}
            var option = {
                    title: {
                        text: 'AH'
                    },
                    tooltip: {
                        trigger: 'axis'
                    },
                    toolbox: {
                        feature: {
                            saveAsImage: {}
                        }
                    },
                    xAxis: {
                        type: 'category',
                        data: {{ timeline|safe }}
                    },
                    yAxis: {
                        type: 'value',
                    },
                    series: [
                        {
                            name:'地电值',
                            type:'line',
                            {#线条颜色#}
                            itemStyle:
                                {
                                    normal:
                                    {
                                        color: '#FF4500'
                                    }
                                },
                            data:{{ ah_value|safe }}
                        },
                    ]};
            {#// 使用刚指定的配置项和数据显示图表。#}
            ah.setOption(option);
        </script>
    </div>
{#    折线图NH#}
    <div id="nh" style="width:100%;height:400px;; ">
        <script type="text/javascript">
            {#// 基于准备好的dom，初始化echarts实例#}
            var ah= echarts.init(document.getElementById('nh'));
            {#// 指定图表的配置项和数据#}
            var option = {
                    title: {
                        text: 'NH'
                    },
                    tooltip: {
                        trigger: 'axis'
                    },
                    toolbox: {
                        feature: {
                            saveAsImage: {}
                        }
                    },
                    xAxis: {
                        type: 'category',
                        data: {{ timeline|safe }}
                    },
                    yAxis: {
                        type: 'value',
                    },
                    series: [
                        {
                            name:'地电值',
                            type:'line',
                            itemStyle:
                                {
                                    normal:
                                    {
                                        color: '#1E90FF'
                                    }
                                },
                            data:{{ nh_value|safe }}
                        },
                    ]};
            {#// 使用刚指定的配置项和数据显示图表。#}
            ah.setOption(option);
        </script>
    </div>
{% endblock 主体 %}